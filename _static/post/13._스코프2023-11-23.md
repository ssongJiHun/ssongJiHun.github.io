---
template : "post"
title : "13. 스코프"
category : ""
tags : "DeepDive"
created: "2023-11-23"
---

# 13. 스코프


## 스코프란?

- 식별자가 유효한 범위다.
- 스코프 내에서는 식별자가 유일해야 하지만 다른 스코프에는 같은 이름을 사용할 수 있게 한다.
- 자바스크립트 엔진이 식별자를 검색할 때 사용하는 규칙이고 네임스페이스다.

> 💡 ES5까지의 자바스크립트는 함수에 의해서만 스코프가 생성된다.  
>   
> var 키워드로 선언된 변수는 같은 스코프 내에서 중복 선언이 허용된다. (재할당)  
> let, const 키워드로 선언된 변수는 같은 스코프 내에서 중복선언을 허용하지 않는다.(문법 에러)


## 스코프 종류


### 전역과 전역 스코프

- 전역은 코드의 가장 바깥 영역이다.
- 전역은 전역 스코프를 만든다.
- 전역에 선언된 전역 변수는 어디든지 참조할 수 있다.

### 지역과 지역 스코프

- 지역이란 함수 몸체 내부를 말한다.
- 지역은 지역 스코프를 만든다.
- 지역에 선언된 지역 변수는 자신의 지역 스코프와 하위 지역 스코프에서 유효하다.

## 스코프 체인

- 함수 몸체 내부에서 함수가 정의된 것을 함수의 중첩이라고 한다.
- 함수 몸체 내부에서 정의한 함수를 **중첩 함수**라고하며,
- 중첩 함수를 포함하는 함수를 **외부 함수**라고 한다.
- 외부 함수의 지역 스코프를 중첩 함수의 상위 스코프라고 한다.
- 스코프가 함수의 중첩에 의해 계층적 구조를 가진다.
- 스코프가 계층적으로 연결된 것을 스코프 체인이라 한다.

```javascript
// 함수의 중첩
var x = 'global';
function outer() { // 외부 함수
	/* 중첩 함수의 상위 스코프 */
  var x = 'outer';
	function inner() { // 중첩 함수
		var x = 'inner';
	}
}
```

- 변수를 참조할 때 자바스크립트는 스코프 체인을 통해 참조한다.
- 변수를 참조하려는 코드의 스코프에서 시작해 상위 스코프 방향으로 이동하며 선언된 변수를 검색한다.
- 스코프 체인은 실행 컨텍스트의 렉시컬 환경을 단방향으로 연결한 것이다.

### 스코프 체인의 변수 검색

- 런타임 이전 소스코드 평가 단계에서 변수 선언은 실행 컨텍스트의 렉시컬 환경(자료구조)에 키로 등록된다.
- 런타임 시점에 변수 할당이 일어나면 렉시컬 환경의 변수 식별자에 값을 변경한다.

### 스코프 체인에 의한 함수 검색

- 함수 선언문으로 정의하면 런타임 이전에 함수 객체가 생성되고,
- 함수 이름과 동일한 식별자가 암묵적으로 선언된다. 이후 생성된 함수 객체를 할당한다.
- 함수도 식별자에 할당되기 때문에 스코프를 갖는다.
- 식별자에 함수 객체가 할당된 것 외에는 일반 변수와 다를 바가 없다.

## 함수 레벨 스코프

- `var` 키워드로 선언된 변수는 함수 코드 블록만 지역으로 인정한다.
- 이러한 특성을 함수 레벨 스코프라고 한다.
- `var` 키워드로 선언된 변수는 코드 블록 내에서 선언되어도 전역 변수다.

## 렉시컬 스코프

- 함수를 어디서 정의했는지에 따라 함수의 상위 스코프가 결정하는 것.
- 이를 렉시컬 스코프 또는 정적 스코프라고 한다.
- 즉, 함수 정의가 평가 되는 시점에 상위 스코프를 결정한다는 것이다.
- 렉시컬 환경을 통해 스코프를 구분하여 식별자를 등록하고 관리한다.
- 자바스크립트 언어는 렉시컬 스코프를 따른다.
